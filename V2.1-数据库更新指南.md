# V2.1 æ•°æ®åº“æ›´æ–°æŒ‡å—

**é‡è¦æ€§**: âš ï¸ å¿…é¡»æ‰§è¡Œï¼Œå¦åˆ™V2.1æ–°åŠŸèƒ½æ— æ³•æ­£å¸¸å·¥ä½œ

---

## ğŸ“‹ æ‰§è¡Œæ­¥éª¤

### 1. æ‰“å¼€Supabase SQL Editor

å·²è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ï¼Œå¦‚æœæ²¡æœ‰æ‰“å¼€ï¼Œè¯·è®¿é—®ï¼š
- https://supabase.com/dashboard/project/_/sql/new

æˆ–è€…ï¼š
1. è®¿é—® https://supabase.com/dashboard
2. é€‰æ‹© **vocab-game** é¡¹ç›®
3. ç‚¹å‡»å·¦ä¾§èœå• **SQL Editor**
4. ç‚¹å‡» **New query** åˆ›å»ºæ–°æŸ¥è¯¢

---

### 2. å¤åˆ¶å¹¶ç²˜è´´ä»¥ä¸‹SQLè„šæœ¬

```sql
-- V2.1 Schema Updates
-- Add daily goal and streak tracking fields to user_profiles

-- Add daily_goal column (default 20 words per day)
ALTER TABLE user_profiles
ADD COLUMN IF NOT EXISTS daily_goal INT DEFAULT 20;

-- Add streak_days column (consecutive learning days)
ALTER TABLE user_profiles
ADD COLUMN IF NOT EXISTS streak_days INT DEFAULT 0;

-- Add last_study_date column (track last study date for streak calculation)
ALTER TABLE user_profiles
ADD COLUMN IF NOT EXISTS last_study_date DATE;

-- Add comments for documentation
COMMENT ON COLUMN user_profiles.daily_goal IS 'æ¯æ—¥å­¦ä¹ ç›®æ ‡å•è¯æ•°';
COMMENT ON COLUMN user_profiles.streak_days IS 'è¿ç»­å­¦ä¹ å¤©æ•°';
COMMENT ON COLUMN user_profiles.last_study_date IS 'æœ€åå­¦ä¹ æ—¥æœŸ';

-- Create index for better performance on date queries
CREATE INDEX IF NOT EXISTS idx_user_profiles_last_study_date
ON user_profiles(last_study_date);

-- Verify the changes
SELECT column_name, data_type, column_default
FROM information_schema.columns
WHERE table_name = 'user_profiles'
AND column_name IN ('daily_goal', 'streak_days', 'last_study_date');
```

---

### 3. æ‰§è¡ŒSQL

1. ç‚¹å‡»å³ä¸‹è§’ **Run** æŒ‰é’®ï¼ˆæˆ–æŒ‰ Ctrl+Enter / Cmd+Enterï¼‰
2. ç­‰å¾…æ‰§è¡Œå®Œæˆ
3. æŸ¥çœ‹æ‰§è¡Œç»“æœ

---

### 4. éªŒè¯ç»“æœ

æ‰§è¡ŒæˆåŠŸåï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹è¾“å‡ºï¼š

| column_name | data_type | column_default |
|-------------|-----------|----------------|
| daily_goal | integer | 20 |
| streak_days | integer | 0 |
| last_study_date | date | NULL |

---

## âœ… å®Œæˆå

æ•°æ®åº“æ›´æ–°å®Œæˆåï¼ŒV2.1çš„æ‰€æœ‰æ–°åŠŸèƒ½å°†ç«‹å³å¯ç”¨ï¼š

1. **æ¯æ—¥å­¦ä¹ ç›®æ ‡ç³»ç»Ÿ**
   - ç”¨æˆ·çš„æ¯æ—¥ç›®æ ‡å°†ä¿å­˜åˆ° `user_profiles.daily_goal`
   - é»˜è®¤å€¼ä¸º20è¯/å¤©

2. **è¿ç»­å­¦ä¹ å¤©æ•°è¿½è¸ª**
   - è¿ç»­å¤©æ•°ä¿å­˜åˆ° `user_profiles.streak_days`
   - æœ€åå­¦ä¹ æ—¥æœŸä¿å­˜åˆ° `user_profiles.last_study_date`
   - ç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—å’Œæ›´æ–°è¿ç»­å¤©æ•°

3. **æ€§èƒ½ä¼˜åŒ–**
   - å·²ä¸º `last_study_date` åˆ›å»ºç´¢å¼•
   - æŸ¥è¯¢è¿ç»­å¤©æ•°çš„æ€§èƒ½å¾—åˆ°ä¼˜åŒ–

---

## ğŸ¯ æ–°å¢å­—æ®µè¯´æ˜

| å­—æ®µå | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `daily_goal` | INT | 20 | æ¯æ—¥å­¦ä¹ ç›®æ ‡å•è¯æ•° |
| `streak_days` | INT | 0 | è¿ç»­å­¦ä¹ å¤©æ•° |
| `last_study_date` | DATE | NULL | æœ€åå­¦ä¹ æ—¥æœŸï¼ˆç”¨äºè®¡ç®—è¿ç»­å¤©æ•°ï¼‰ |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **IF NOT EXISTS**: SQLä½¿ç”¨äº† `IF NOT EXISTS`ï¼Œæ‰€ä»¥é‡å¤æ‰§è¡Œä¸ä¼šæŠ¥é”™
2. **å·²æœ‰ç”¨æˆ·**: å·²æœ‰ç”¨æˆ·çš„ `daily_goal` ä¼šè‡ªåŠ¨è®¾ç½®ä¸º20ï¼Œ`streak_days` ä¼šè®¾ç½®ä¸º0
3. **æ— æ•°æ®ä¸¢å¤±**: æ­¤æ›´æ–°åªæ˜¯æ·»åŠ æ–°åˆ—ï¼Œä¸ä¼šå½±å“ç°æœ‰æ•°æ®
4. **ç«‹å³ç”Ÿæ•ˆ**: æ‰§è¡ŒæˆåŠŸåï¼Œæ–°åŠŸèƒ½ç«‹å³å¯ç”¨ï¼Œæ— éœ€é‡å¯åº”ç”¨

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¦‚æœæ‰§è¡Œå¤±è´¥ï¼š

1. **æƒé™é—®é¢˜**ï¼šç¡®ä¿æ‚¨çš„Supabaseè´¦æˆ·æœ‰è¶³å¤Ÿçš„æƒé™ä¿®æ”¹è¡¨ç»“æ„
2. **è¡¨ä¸å­˜åœ¨**ï¼šç¡®ä¿ `user_profiles` è¡¨å·²ç»å­˜åœ¨
3. **è¿æ¥é—®é¢˜**ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œç¡®ä¿èƒ½è®¿é—®Supabase

### å¦‚æœä¸ç¡®å®šæ˜¯å¦æˆåŠŸï¼š

è¿è¡Œä»¥ä¸‹æŸ¥è¯¢æ£€æŸ¥ï¼š
```sql
SELECT column_name, data_type, column_default
FROM information_schema.columns
WHERE table_name = 'user_profiles'
AND column_name IN ('daily_goal', 'streak_days', 'last_study_date');
```

åº”è¯¥è¿”å›3è¡Œæ•°æ®ã€‚

---

**æ‰§è¡Œå®Œæ¯•åï¼ŒV2.1å°±100%å®Œæˆéƒ¨ç½²äº†ï¼** ğŸ‰
