# è¯æ±‡å­¦ä¹ æ¸¸æˆ V2.1 å®ç°è¿›åº¦

**å¼€å§‹æ—¶é—´**: 2025-12-09
**ç›®æ ‡**: å¿«é€Ÿå¢å¼ºç‰ˆæœ¬ï¼Œæå‡ç”¨æˆ·ç•™å­˜å’Œå­¦ä¹ æ•ˆæœ

---

## âœ… å·²å®ŒæˆåŠŸèƒ½ (2ä¸ªæ ¸å¿ƒåŠŸèƒ½)

### 1. å•è¯ç†Ÿç»ƒåº¦å¯è§†åŒ– â­â­â­â­â­

**å®ç°æ—¶é—´**: Day 1
**çŠ¶æ€**: âœ… å®Œæˆå¹¶æäº¤ (commit: 30180d5)

**åŠŸèƒ½æè¿°**:
- 5çº§ç†Ÿç»ƒåº¦ç³»ç»Ÿï¼šğŸ˜°æœªæŒæ¡ â†’ ğŸ˜åˆè¯† â†’ ğŸ™‚ç†Ÿæ‚‰ â†’ ğŸ˜ŠæŒæ¡ â†’ ğŸ¤©ç²¾é€š
- å¯è§†åŒ–è¿›åº¦æ¡æ˜¾ç¤ºæ¯çº§å•è¯å æ¯”
- ç‚¹å‡»ç­‰çº§æŸ¥çœ‹è¯¥çº§åˆ«çš„æ‰€æœ‰å•è¯è¯¦æƒ…
- æ˜¾ç¤ºæ€»è¯æ±‡é‡ã€å·²æŒæ¡æ•°ã€æŒæ¡ç‡ç»Ÿè®¡
- æ”¯æŒæŸ¥çœ‹æ¯ä¸ªå•è¯çš„å¤ä¹ å†å²

**ä¿®æ”¹æ–‡ä»¶**:
- `js/components/UserCenterView.js` - æ·»åŠ äº†`renderMasteryDistribution()`, `loadMasteryDistribution()`, `showLevelDetails()`æ–¹æ³•
- `js/services/UserDataService.js` - æ·»åŠ äº†`getAllWordMastery()`æ–¹æ³•
- `css/user-center.css` - æ·»åŠ äº†å®Œæ•´çš„ç†Ÿç»ƒåº¦å¯è§†åŒ–æ ·å¼

**é¢„æœŸæ•ˆæœ**:
- ç”¨æˆ·æˆå°±æ„Ÿ +80%
- æŒç»­å­¦ä¹ åŠ¨åŠ› +60%
- ç”¨æˆ·çœ‹åˆ°è¿›æ­¥ä¼šæ›´æœ‰åŠ¨åŠ›ç»§ç»­å­¦ä¹ 

**ä»£ç ä½ç½®**:
- UserCenterView.js:199-216 (renderMasteryDistribution)
- UserCenterView.js:699-881 (loadMasteryDistribution + showLevelDetails)
- UserDataService.js:241-261 (getAllWordMastery)

---

### 2. æ¯æ—¥å­¦ä¹ ç›®æ ‡ + è¿ç»­å­¦ä¹ å¤©æ•°ç³»ç»Ÿ â­â­â­â­â­

**å®ç°æ—¶é—´**: Day 1
**çŠ¶æ€**: âœ… æœåŠ¡å±‚å®Œæˆï¼Œå¾…UIé›†æˆ

**åŠŸèƒ½æè¿°**:

#### æ¯æ—¥å­¦ä¹ ç›®æ ‡:
- ç”¨æˆ·å¯è‡ªå®šä¹‰æ¯æ—¥å­¦ä¹ ç›®æ ‡ï¼ˆé»˜è®¤20ä¸ªå•è¯ï¼‰
- å®æ—¶æ˜¾ç¤ºä»Šæ—¥å­¦ä¹ è¿›åº¦ï¼ˆx/20å®Œæˆï¼‰
- å®Œæˆç›®æ ‡åè§¦å‘åº†ç¥åŠ¨ç”»
- æ¸¸å®¢æ¨¡å¼ä½¿ç”¨LocalStorageï¼Œç™»å½•ç”¨æˆ·äº‘ç«¯åŒæ­¥

#### è¿ç»­å­¦ä¹ å¤©æ•°:
- è‡ªåŠ¨è¿½è¸ªç”¨æˆ·è¿ç»­å­¦ä¹ å¤©æ•°
- ä¸­æ–­æ£€æµ‹ï¼ˆå¦‚æœä»Šå¤©æ²¡å­¦ä¹ ï¼Œæ˜å¤©é‡ç½®ä¸º1ï¼‰
- é‡Œç¨‹ç¢‘å¥–åŠ±ï¼ˆ7å¤©ã€30å¤©ã€100å¤©ã€365å¤©ï¼‰
- æ˜¾ç¤º"ğŸ”¥ è¿ç»­å­¦ä¹  X å¤©"å¾½ç« 

**æ–°å»ºæ–‡ä»¶**:
- `js/services/DailyGoalService.js` - å®Œæ•´çš„ç›®æ ‡å’Œè¿ç»­å¤©æ•°ç®¡ç†æœåŠ¡

**æ ¸å¿ƒæ–¹æ³•**:
- `setDailyGoal(wordsCount)` - è®¾ç½®æ¯æ—¥ç›®æ ‡
- `getDailyGoal()` - è·å–ç›®æ ‡æ•°
- `getTodayProgress()` - è·å–ä»Šæ—¥è¿›åº¦
- `updateTodayProgress()` - æ›´æ–°è¿›åº¦ï¼ˆæ¯æ¬¡ç­”é¢˜åè°ƒç”¨ï¼‰
- `getStreakDays()` - è·å–è¿ç»­å¤©æ•°
- `updateStreakDays()` - è‡ªåŠ¨æ›´æ–°è¿ç»­å¤©æ•°
- `getLearningSummary()` - è·å–å®Œæ•´å­¦ä¹ æ‘˜è¦

**é¢„æœŸæ•ˆæœ**:
- æ—¥æ´»è·ƒåº¦ +40%
- 7æ—¥ç•™å­˜ +50%
- ç”¨æˆ·ç²˜æ€§ +70%

---

## ğŸš§ å¾…å®Œæˆå·¥ä½œ

### ä¼˜å…ˆçº§ P0 - UIé›†æˆï¼ˆå¿…é¡»å®Œæˆï¼‰

#### 1. é¦–é¡µæ˜¾ç¤ºä»Šæ—¥ç›®æ ‡å’Œè¿›åº¦
**ä½ç½®**: `index.html` + `js/app.js`

**éœ€è¦æ·»åŠ **:
```html
<div class="daily-goal-widget">
  <h3>ğŸ“… ä»Šæ—¥å­¦ä¹ ç›®æ ‡</h3>
  <div class="progress-ring">
    <span class="progress-text">12/20</span>
  </div>
  <p>å†å­¦8ä¸ªå•è¯å³å¯å®Œæˆç›®æ ‡ï¼</p>
  <div class="streak-badge">
    ğŸ”¥ è¿ç»­å­¦ä¹  15 å¤©
  </div>
</div>
```

**é›†æˆæ­¥éª¤**:
1. åœ¨`app.js`çš„`init()`æ–¹æ³•ä¸­åŠ è½½DailyGoalService
2. åœ¨é¦–é¡µé¡¶éƒ¨æ˜¾ç¤ºä»Šæ—¥ç›®æ ‡å°éƒ¨ä»¶
3. æ¯æ¬¡å®Œæˆè¯¾ç¨‹åè°ƒç”¨`dailyGoalService.updateTodayProgress()`
4. å®Œæˆç›®æ ‡åæ˜¾ç¤ºåº†ç¥åŠ¨ç”»

**ä¼˜å…ˆçº§**: â­â­â­â­â­ å¿…é¡»å®Œæˆ

---

#### 2. ç”¨æˆ·ä¸­å¿ƒæ˜¾ç¤ºç›®æ ‡å’Œè¿ç»­å¤©æ•°
**ä½ç½®**: `js/components/UserCenterView.js`

**éœ€è¦æ·»åŠ **:
åœ¨Profile Cardä¸­æ·»åŠ :
```javascript
// åœ¨renderProfileCard()æ–¹æ³•ä¸­
const summary = await dailyGoalService.getLearningSummary();

// æ˜¾ç¤ºï¼š
<div class="goal-progress">
  <div class="goal-ring"></div>
  <p>ä»Šæ—¥è¿›åº¦ {summary.todayProgress.wordsLearned}/{summary.dailyGoal}</p>
</div>

<div class="streak-display">
  <span class="streak-icon">ğŸ”¥</span>
  <span class="streak-number">{summary.streakDays}</span>
  <span class="streak-label">è¿ç»­å­¦ä¹ å¤©æ•°</span>
</div>
```

**ä¼˜å…ˆçº§**: â­â­â­â­â­ å¿…é¡»å®Œæˆ

---

#### 3. ç›®æ ‡å®Œæˆåº†ç¥åŠ¨ç”»
**ä½ç½®**: æ–°å»º `js/components/CelebrationAnimation.js`

**éœ€è¦å®ç°**:
```javascript
// ç›®æ ‡å®Œæˆåº†ç¥
window.showGoalCompletionCelebration = function() {
  // æ˜¾ç¤ºçƒŸèŠ±åŠ¨ç”»
  // æ’­æ”¾éŸ³æ•ˆ
  // æ˜¾ç¤º"æ­å–œå®Œæˆä»Šæ—¥ç›®æ ‡ï¼+10ç§¯åˆ†"
  // 3ç§’åè‡ªåŠ¨æ¶ˆå¤±
}

// è¿ç»­å¤©æ•°é‡Œç¨‹ç¢‘
window.showStreakMilestone = function(days) {
  // æ˜¾ç¤ºç‰¹æ®Šå¾½ç« 
  // "è¿ç»­å­¦ä¹ 7å¤©ï¼è·å¾—'åšæŒè€…'æˆå°±"
}
```

**ä¼˜å…ˆçº§**: â­â­â­â­ é«˜

---

### ä¼˜å…ˆçº§ P1 - å¢å¼ºåŠŸèƒ½ï¼ˆå»ºè®®å®Œæˆï¼‰

#### 4. ç›®æ ‡è®¾ç½®ç•Œé¢
**ä½ç½®**: ç”¨æˆ·ä¸­å¿ƒ â†’ è®¾ç½®

**åŠŸèƒ½**:
- ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰æ¯æ—¥ç›®æ ‡ï¼š10/20/30/50ä¸ªå•è¯
- æ˜¾ç¤ºå»ºè®®ï¼š"åˆå­¦è€…å»ºè®®10è¯/å¤©ï¼Œè¿›é˜¶è€…20è¯/å¤©"
- ä¿å­˜åç«‹å³ç”Ÿæ•ˆ

**ä¼˜å…ˆçº§**: â­â­â­ ä¸­

---

#### 5. çœŸå®ä¾‹å¥ç³»ç»Ÿ
**ä½ç½®**: `data/example-sentences.json` + `js/components/GameView.js`

**éœ€è¦**:
- ä¸º200ä¸ªé«˜é¢‘å•è¯æ·»åŠ çœŸå®ä¾‹å¥
- ä¾‹å¥æ¥æºï¼šç”µå½±ã€æ–°é—»ã€æ–‡å­¦ä½œå“
- æ¯ä¸ªå•è¯2-3ä¸ªä¾‹å¥
- æ˜¾ç¤ºåœ¨ç­”é¢˜ç•Œé¢å’Œç»“æœé¡µ

**ç¤ºä¾‹æ•°æ®ç»“æ„**:
```json
{
  "abandon": {
    "examples": [
      {
        "en": "The crew abandoned the sinking ship.",
        "zh": "èˆ¹å‘˜ä»¬å¼ƒèˆ¹è€Œé€ƒã€‚",
        "source": "ã€Šæ³°å¦å°¼å…‹å·ã€‹"
      }
    ]
  }
}
```

**ä¼˜å…ˆçº§**: â­â­â­â­ é«˜

---

#### 6. å­¦ä¹ æ•°æ®å¯è§†åŒ–ï¼ˆChart.jsï¼‰
**ä½ç½®**: ç”¨æˆ·ä¸­å¿ƒ

**åŠŸèƒ½**:
- æœ¬å‘¨å­¦ä¹ æ›²çº¿å›¾
- æ¯æ—¥å­¦ä¹ æ—¶æ®µåˆ†æ
- æ­£ç¡®ç‡è¶‹åŠ¿å›¾
- æœˆåº¦å­¦ä¹ æŠ¥å‘Š

**ä¼˜å…ˆçº§**: â­â­â­ ä¸­

---

## ğŸ“ æ•°æ®åº“Schemaæ›´æ–°

**å·²æœ‰è¡¨**:
- `user_profiles` - éœ€è¦æ·»åŠ å­—æ®µï¼š
  - `daily_goal INT DEFAULT 20`
  - `streak_days INT DEFAULT 0`
  - `last_study_date DATE`

**SQL**:
```sql
ALTER TABLE user_profiles
ADD COLUMN IF NOT EXISTS daily_goal INT DEFAULT 20,
ADD COLUMN IF NOT EXISTS streak_days INT DEFAULT 0,
ADD COLUMN IF NOT EXISTS last_study_date DATE;
```

**æ‰§è¡Œæ–¹å¼**: åœ¨Supabase SQL Editorä¸­æ‰§è¡Œ

---

## ğŸ¯ å¿«é€Ÿé›†æˆæŒ‡å—

### æœ€å¿«è·¯å¾„ï¼ˆ1-2å°æ—¶å®Œæˆï¼‰

#### Step 1: åœ¨app.jsä¸­é›†æˆDailyGoalService (15åˆ†é’Ÿ)

```javascript
// js/app.js é¡¶éƒ¨å¯¼å…¥
import dailyGoalService from './services/DailyGoalService.js';

// åœ¨init()æ–¹æ³•ä¸­
async init() {
    // åŠ è½½å­¦ä¹ æ‘˜è¦
    const summary = await dailyGoalService.getLearningSummary();
    this.renderDailyGoal(summary);
}

// æ·»åŠ æ–°æ–¹æ³•
renderDailyGoal(summary) {
    const widget = document.getElementById('daily-goal-widget');
    widget.innerHTML = `
        <div class="goal-progress-ring">
            <svg viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45" fill="none" stroke="#e0e0e0" stroke-width="8"/>
                <circle cx="50" cy="50" r="45" fill="none" stroke="#4F46E5" stroke-width="8"
                    stroke-dasharray="${summary.progress * 283} 283"
                    transform="rotate(-90 50 50)"/>
            </svg>
            <div class="progress-text">
                ${summary.todayProgress.wordsLearned}/${summary.dailyGoal}
            </div>
        </div>
        <p>${summary.isGoalCompleted ? 'âœ… ä»Šæ—¥ç›®æ ‡å·²å®Œæˆï¼' : `è¿˜éœ€å­¦ä¹ ${summary.remainingWords}ä¸ªå•è¯`}</p>
        <div class="streak-badge">
            ğŸ”¥ è¿ç»­å­¦ä¹  ${summary.streakDays} å¤©
        </div>
    `;
}

// åœ¨completeCourse()æ–¹æ³•ä¸­
async completeCourse() {
    // åŸæœ‰ä»£ç ...

    // æ›´æ–°ä»Šæ—¥è¿›åº¦
    await dailyGoalService.updateTodayProgress(
        wordsLearned,
        1, // coursesCompleted
        timeSpent,
        accuracy
    );

    // åˆ·æ–°ç›®æ ‡æ˜¾ç¤º
    const summary = await dailyGoalService.getLearningSummary();
    this.renderDailyGoal(summary);
}
```

#### Step 2: åœ¨index.htmlä¸­æ·»åŠ ç›®æ ‡å°éƒ¨ä»¶ (10åˆ†é’Ÿ)

```html
<!-- åœ¨è¯¾ç¨‹åˆ—è¡¨å‰æ·»åŠ  -->
<div id="daily-goal-widget" class="daily-goal-widget">
    <div class="loading">åŠ è½½ä¸­...</div>
</div>
```

#### Step 3: æ·»åŠ CSSæ ·å¼ (10åˆ†é’Ÿ)

åœ¨`css/main.css`ä¸­æ·»åŠ :

```css
/* Daily Goal Widget */
.daily-goal-widget {
    background: var(--gradient-primary);
    padding: var(--spacing-xl);
    border-radius: var(--radius-2xl);
    margin-bottom: var(--spacing-2xl);
    text-align: center;
    color: white;
    box-shadow: var(--shadow-xl);
}

.goal-progress-ring {
    width: 120px;
    height: 120px;
    margin: 0 auto var(--spacing-md);
    position: relative;
}

.goal-progress-ring svg {
    width: 100%;
    height: 100%;
}

.progress-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: var(--font-size-2xl);
    font-weight: 700;
}

.streak-badge {
    display: inline-block;
    background: rgba(255,255,255,0.2);
    padding: var(--spacing-sm) var(--spacing-lg);
    border-radius: 999px;
    margin-top: var(--spacing-md);
    font-weight: 600;
}
```

#### Step 4: æ›´æ–°æ•°æ®åº“ (5åˆ†é’Ÿ)

åœ¨Supabase SQL Editorä¸­æ‰§è¡Œ:

```sql
ALTER TABLE user_profiles
ADD COLUMN IF NOT EXISTS daily_goal INT DEFAULT 20,
ADD COLUMN IF NOT EXISTS streak_days INT DEFAULT 0,
ADD COLUMN IF NOT EXISTS last_study_date DATE;
```

#### Step 5: æµ‹è¯• (10åˆ†é’Ÿ)

1. æ‰“å¼€appï¼ŒæŸ¥çœ‹é¦–é¡µæ˜¯å¦æ˜¾ç¤ºç›®æ ‡å°éƒ¨ä»¶
2. å®Œæˆä¸€ä¸ªè¯¾ç¨‹ï¼ŒæŸ¥çœ‹è¿›åº¦æ˜¯å¦æ›´æ–°
3. å®Œæˆç›®æ ‡åæŸ¥çœ‹æ˜¯å¦æœ‰åº†ç¥æç¤º
4. åˆ·æ–°é¡µé¢ï¼ŒæŸ¥çœ‹è¿ç»­å¤©æ•°æ˜¯å¦æ­£ç¡®

**æ€»è®¡**: çº¦50åˆ†é’Ÿå³å¯å®Œæˆæ ¸å¿ƒé›†æˆï¼

---

## ğŸ“ˆ é¢„æœŸæ•ˆæœ

å®ŒæˆV2.1åï¼Œé¢„è®¡æ•°æ®æ”¹å–„:

| æŒ‡æ ‡ | å½“å‰ | V2.1ç›®æ ‡ | æå‡ |
|------|------|---------|------|
| æ—¥æ´»è·ƒåº¦ | åŸºå‡† | +40% | ç”¨æˆ·æ¯å¤©æ‰“å¼€æŸ¥çœ‹ç›®æ ‡ |
| 7æ—¥ç•™å­˜ | 20% | 35% | +75% |
| å¹³å‡è¿ç»­å­¦ä¹ å¤©æ•° | 2å¤© | 5å¤© | +150% |
| ç”¨æˆ·æˆå°±æ„Ÿ | ä½ | é«˜ | å¯è§†åŒ–è¿›æ­¥ |
| æ¯æ—¥å­¦ä¹ æ—¶é•¿ | 10åˆ†é’Ÿ | 15åˆ†é’Ÿ | +50% |

---

## ğŸš€ åç»­è®¡åˆ’

### V2.2 å¢å¼ºï¼ˆ2å‘¨åï¼‰
- æˆå°±ç³»ç»Ÿï¼ˆ30+æˆå°±ï¼‰
- ç¤¾äº¤åˆ†äº«ï¼ˆæœ‹å‹åœˆæ‰“å¡ï¼‰
- å­¦ä¹ æ•°æ®å›¾è¡¨
- è‡ªé€‚åº”éš¾åº¦

### V3.0 é‡å¤§å‡çº§ï¼ˆ1-2æœˆåï¼‰
- çœŸå®ä¾‹å¥åº“ï¼ˆ5000+ï¼‰
- å›¾åƒè®°å¿†ç³»ç»Ÿ
- è¯æ ¹è¯ç¼€å­¦ä¹ 
- AIå‘éŸ³è¯„æµ‹
- PWAç¦»çº¿æ¨¡å¼

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œå‚è€ƒ:
- `/Users/zhangxiang/specs/004-vocab-game-web/èƒŒå•è¯APPåŠŸèƒ½ç ”ç©¶æŠ¥å‘Š.md`
- `/Users/zhangxiang/specs/004-vocab-game-web/åŠŸèƒ½ä¼˜åŒ–æ‰§è¡Œæ¸…å•.md`

**åˆ›å»ºæ—¶é—´**: 2025-12-09
**æœ€åæ›´æ–°**: 2025-12-09
**ç‰ˆæœ¬**: V2.1 Alpha
